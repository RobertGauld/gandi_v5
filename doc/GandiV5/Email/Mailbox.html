<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: GandiV5::Email::Mailbox
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "GandiV5::Email::Mailbox";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span>
     &raquo; 
    <span class="title">Mailbox</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: GandiV5::Email::Mailbox
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">GandiV5::Email::Mailbox</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/gandi_v5/email/mailbox.rb<span class="defines">,<br />
  lib/gandi_v5/email/mailbox/responder.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A mailbox that lives within a domain.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="TYPES-constant" class="">TYPES =
          
        </dt>
        <dd><pre class="code"><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="QUOTAS-constant" class="">QUOTAS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
  <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
  <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
<span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#address-instance_method" title="#address (instance method)">#<strong>address</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Full email address.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#aliases-instance_method" title="#aliases (instance method)">#<strong>aliases</strong>  &#x21d2; nil, Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Mailbox alias list.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#fallback_email-instance_method" title="#fallback_email (instance method)">#<strong>fallback_email</strong>  &#x21d2; nil, String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Fallback email addresse.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#fqdn-instance_method" title="#fqdn (instance method)">#<strong>fqdn</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Domain name.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#login-instance_method" title="#login (instance method)">#<strong>login</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Mailbox login.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#quota_used-instance_method" title="#quota_used (instance method)">#<strong>quota_used</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#responder-instance_method" title="#responder (instance method)">#<strong>responder</strong>  &#x21d2; nil, GandiV5::Email::Mailbox::Responder </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">#<strong>type</strong>  &#x21d2; :standard, ... </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#uuid-instance_method" title="#uuid (instance method)">#<strong>uuid</strong>  &#x21d2; String </a>
    

    
      (also: #mailbox_uuid)
    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-class_method" title="create (class method)">.<strong>create</strong>(fqdn, login, password, aliases: [], type: :standard)  &#x21d2; GandiV5::Email::Mailbox </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fetch-class_method" title="fetch (class method)">.<strong>fetch</strong>(fqdn, uuid)  &#x21d2; GandiV5::Email::Mailbox </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get information for a mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#list-class_method" title="list (class method)">.<strong>list</strong>(fqdn, page: (1..), **params)  &#x21d2; Array&lt;GandiV5::Email::Mailbox&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>List mailboxes for a domain.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete the mailbox and it&#39;s contents.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(**members)  &#x21d2; GandiV5::Email::Slot </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new GandiV5::Email::Mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#purge-instance_method" title="#purge (instance method)">#<strong>purge</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Purge the contents of the mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#quota-instance_method" title="#quota (instance method)">#<strong>quota</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the quota for this type of mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#quota_usage-instance_method" title="#quota_usage (instance method)">#<strong>quota_usage</strong>  &#x21d2; Float </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the quota usage for this mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#refresh-instance_method" title="#refresh (instance method)">#<strong>refresh</strong>  &#x21d2; GandiV5::Email::Mailbox </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Requery Gandi fo this mailbox&#39;s information.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the string representation of the mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update-instance_method" title="#update (instance method)">#<strong>update</strong>(**body)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Update the mailbox&#39;s settings.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Data.html#from_gandi-instance_method" title="GandiV5::Data#from_gandi (method)">#from_gandi</a></span>, <span class='object_link'><a href="../Data.html#included-class_method" title="GandiV5::Data.included (method)">included</a></span>, <span class='object_link'><a href="../Data.html#to_gandi-instance_method" title="GandiV5::Data#to_gandi (method)">#to_gandi</a></span>, <span class='object_link'><a href="../Data.html#to_h-instance_method" title="GandiV5::Data#to_h (method)">#to_h</a></span>, <span class='object_link'><a href="../Data.html#values_at-instance_method" title="GandiV5::Data#values_at (method)">#values_at</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(**members)  &#x21d2; <tt><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">GandiV5::Email::Slot</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a new GandiV5::Email::Mailbox</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>members</span>
      
      
        <span class='type'>(<tt>Hash&lt;Symbol =&gt; Object&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="address-instance_method">
  
    #<strong>address</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns full email address.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>full email address.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="aliases-instance_method">
  
    #<strong>aliases</strong>  &#x21d2; <tt>nil</tt>, <tt>Array&lt;String&gt;</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns mailbox alias list. A local-part (what comes before the “@”) of an email address. It can contain a wildcard “*” before or after at least two characters to redirect everything thats matches the local-part pattern.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>mailbox alias list. A local-part (what comes before the “@”) of an email address. It can contain a wildcard “*” before or after at least two characters to redirect everything thats matches the local-part pattern.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="fallback_email-instance_method">
  
    #<strong>fallback_email</strong>  &#x21d2; <tt>nil</tt>, <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns fallback email addresse.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>fallback email addresse.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="fqdn-instance_method">
  
    #<strong>fqdn</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns domain name.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>domain name.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="login-instance_method">
  
    #<strong>login</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns mailbox login.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>mailbox login.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="quota_used-instance_method">
  
    #<strong>quota_used</strong>  &#x21d2; <tt>Integer</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="responder-instance_method">
  
    #<strong>responder</strong>  &#x21d2; <tt>nil</tt>, <tt><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">GandiV5::Email::Mailbox::Responder</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>, <tt><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">GandiV5::Email::Mailbox::Responder</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    #<strong>type</strong>  &#x21d2; <tt>:standard</tt>, ...  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>:standard</tt>, <tt>:premium</tt>, <tt>:free</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="uuid-instance_method">
  
    #<strong>uuid</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='mailbox_uuid-instance_method'>mailbox_uuid</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 29</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span>

  <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span> <span class='op'>=</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>standard</span><span class='words_sep'> </span><span class='tstring_content'>premium</span><span class='words_sep'> </span><span class='tstring_content'>free</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>free:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>standard:</span> <span class='int'>3</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span><span class='comma'>,</span>
    <span class='label'>premium:</span> <span class='int'>50</span> <span class='op'>*</span> <span class='int'>1024</span><span class='op'>**</span><span class='int'>3</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>

  <span class='id identifier rubyid_members'>members</span> <span class='symbol'>:address</span><span class='comma'>,</span> <span class='symbol'>:login</span><span class='comma'>,</span> <span class='symbol'>:quota_used</span><span class='comma'>,</span> <span class='symbol'>:aliases</span><span class='comma'>,</span> <span class='symbol'>:fallback_email</span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:type</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mailbox_type</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data.html" title="GandiV5::Data (module)">Data</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter.html" title="GandiV5::Data::Converter (class)">Converter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Data/Converter/Symbol.html" title="GandiV5::Data::Converter::Symbol (class)">Symbol</a></span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:uuid</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:fqdn</span><span class='comma'>,</span> <span class='label'>gandi_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_member'>member</span> <span class='symbol'>:responder</span><span class='comma'>,</span> <span class='label'>converter:</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">Mailbox</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mailbox/Responder.html" title="GandiV5::Email::Mailbox::Responder (class)">Responder</a></span></span>

  <span class='kw'>alias</span> <span class='id identifier rubyid_mailbox_uuid'>mailbox_uuid</span> <span class='id identifier rubyid_uuid'>uuid</span>

  <span class='comment'># Create a new GandiV5::Email::Mailbox
</span>  <span class='comment'># @param members [Hash&lt;Symbol =&gt; Object&gt;]
</span>  <span class='comment'># @return [GandiV5::Email::Slot]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_members'>members</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete the mailbox and it&#39;s contents.
</span>  <span class='comment'># If you delete a mailbox for which you have purchased a slot,
</span>  <span class='comment'># this action frees the slot so it once again becomes available
</span>  <span class='comment'># for use with a new mailbox, or for deletion.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Purge the contents of the mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Requery Gandi fo this mailbox&#39;s information.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the mailbox&#39;s settings.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param responder [Hash, GandiV5::Mailbox::Responder, #to_gandi, #to_h]
</span>  <span class='comment'>#   auto responder settings.
</span>  <span class='comment'># @return [String] The confirmation message from Gandi.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
    <span class='id identifier rubyid_refresh'>refresh</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Create a new mailbox.
</span>  <span class='comment'># Note that before you can create a mailbox, you must have a slot available.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param login [String, #to_s] the login name (and first part of email address).
</span>  <span class='comment'># @param password [String, #to_s] the password to use.
</span>  <span class='comment'># @param aliases [Array&lt;String, #to_s&gt;] any alternative email address to be used.
</span>  <span class='comment'># @param type [:standard, :premium] the type of mailbox slot to use.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox] The created mailbox.
</span>  <span class='comment'># @raise [GandiV5::Error] if no slots are available.
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

    <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
      <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

    <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># Get information for a mailbox.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailbox.
</span>  <span class='comment'># @param uuid [String, #to_s] unique identifier of the mailbox.
</span>  <span class='comment'># @return [GandiV5::Email::Mailbox]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='comment'># List mailboxes for a domain.
</span>  <span class='comment'># @see https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain
</span>  <span class='comment'># @param fqdn [String, #to_s] the fully qualified domain name for the mailboxes.
</span>  <span class='comment'># @param page [Integer, #each&lt;Integer&gt;] which page(s) of results to get.
</span>  <span class='comment'>#   If page is not provided keep querying until an empty list is returned.
</span>  <span class='comment'>#   If page responds to .each then iterate until an empty list is returned.
</span>  <span class='comment'># @param per_page [Integer, #to_s] (optional default 100) how many results ot get per page.
</span>  <span class='comment'># @param sort_by [#to_s] (optional default &quot;login&quot;)
</span>  <span class='comment'>#   how to sort the results (&quot;login&quot;, &quot;-login&quot;).
</span>  <span class='comment'># @param login [String] (optional) filter the list by login (pattern)
</span>  <span class='comment'>#   e.g. (&quot;alice&quot; &quot;*lice&quot;, &quot;alic*&quot;).
</span>  <span class='comment'># @return [Array&lt;GandiV5::Email::Mailbox&gt;]
</span>  <span class='comment'># @raise [GandiV5::Error::GandiError] if Gandi returns an error.
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
      <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
      <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mailboxes'>mailboxes</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota for this type of mailbox.
</span>  <span class='comment'># @return [Integer] bytes.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
    <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Get the quota usage for this mailbox.
</span>  <span class='comment'># @return [Float] fraction of quota used (typically between 0.0 and 1.0)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
    <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='kw'>end</span>

  <span class='comment'># Returns the string representation of the mailbox.
</span>  <span class='comment'># Includes the type, address, quota usage, activeness of responder (if present)
</span>  <span class='comment'># and aliases (if present).
</span>  <span class='comment'># @return [String]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='comment'># rubocop:disable Style/GuardClause
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='lparen'>(</span><span class='int'>9</span><span class='op'>..</span><span class='int'>200</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must be between 9 and 200 characters</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A-Z</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one upper case character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>3</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least three numbers</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^a-z^A-Z^0-9</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>password must contain at least one special character</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:check_password</span>
  <span class='comment'># rubocop:enable Style/GuardClause
</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_check_password'>check_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:check_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_url'>url</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../../GandiV5.html#BASE-constant" title="GandiV5::BASE (constant)">BASE</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>email/mailboxes/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_uuid'>uuid</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:url</span>

  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='comment'># You can also send a hashed password in sha512-crypt ie: {SHA512-CRYPT}$6$xxxx$yyyy
</span>    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_random_number'>random_number</span><span class='lparen'>(</span><span class='int'>36</span><span class='op'>**</span><span class='int'>8</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>36</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_crypt'>crypt</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>$6$</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_private_class_method'>private_class_method</span> <span class='symbol'>:crypt_password</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='symbol'>:crypt_password</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create-class_method">
  
    .<strong>create</strong>(fqdn, login, password, aliases: [], type: :standard)  &#x21d2; <tt><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a new mailbox. Note that before you can create a mailbox, you must have a slot available.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>fqdn</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the fully qualified domain name for the mailbox.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>login</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the login name (and first part of email address).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the password to use.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>aliases</span>
      
      
        <span class='type'>(<tt>Array&lt;String, #<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>any alternative email address to be used.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>:standard</tt>, <tt>:premium</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the type of mailbox slot to use.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The created mailbox.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">GandiV5::Error</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if no slots are available.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/GandiError.html" title="GandiV5::Error::GandiError (class)">GandiV5::Error::GandiError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if Gandi returns an error.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain" target="_parent" title="https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain">https://api.gandi.net/docs/email#post-v5-email-mailboxes-domain</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 121</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='label'>aliases:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:standard</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fail'>fail</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid type</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#TYPES-constant" title="GandiV5::Email::Mailbox::TYPES (constant)">TYPES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Email.html" title="GandiV5::Email (class)">Email</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Slot.html" title="GandiV5::Email::Slot (class)">Slot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_list'><span class='object_link'><a href="Slot.html#list-class_method" title="GandiV5::Email::Slot.list (method)">list</a></span></span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_slot'>slot</span><span class='op'>|</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_mailbox_type'>mailbox_type</span> <span class='op'>==</span> <span class='id identifier rubyid_type'>type</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_slot'>slot</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Error.html" title="GandiV5::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no available </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'> slots</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_password'>password</span>

  <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>mailbox_type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
    <span class='label'>login:</span> <span class='id identifier rubyid_login'>login</span><span class='comma'>,</span>
    <span class='label'>password:</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>aliases:</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>

  <span class='id identifier rubyid_response'>response</span><span class='comma'>,</span> <span class='id identifier rubyid__data'>_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_post'><span class='object_link'><a href="../../GandiV5.html#post-class_method" title="GandiV5.post (method)">post</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span>
  <span class='id identifier rubyid_fetch'>fetch</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fetch-class_method">
  
    .<strong>fetch</strong>(fqdn, uuid)  &#x21d2; <tt><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get information for a mailbox.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>fqdn</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the fully qualified domain name for the mailbox.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uuid</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>unique identifier of the mailbox.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/GandiError.html" title="GandiV5::Error::GandiError (class)">GandiV5::Error::GandiError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if Gandi returns an error.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id" target="_parent" title="https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id">https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain-mailbox_id</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 146</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_uuid'>uuid</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="list-class_method">
  
    .<strong>list</strong>(fqdn, page: (1..), **params)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>List mailboxes for a domain.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>fqdn</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the fully qualified domain name for the mailboxes.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>page</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>#each&lt;Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>which page(s) of results to get. If page is not provided keep querying until an empty list is returned. If page responds to .each then iterate until an empty list is returned.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>per_page</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(optional default 100) how many results ot get per page.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sort_by</span>
      
      
        <span class='type'>(<tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(optional default “login”) how to sort the results (“login”, “-login”).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>login</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>(optional) filter the list by login (pattern) e.g. (“alice” “*lice”, “alic*”).</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/GandiError.html" title="GandiV5::Error::GandiError (class)">GandiV5::Error::GandiError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if Gandi returns an error.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain" target="_parent" title="https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain">https://api.gandi.net/docs/email#get-v5-email-mailboxes-domain</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 164</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='label'>page:</span> <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_page'>page</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:each</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~login</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__k'>_k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_page_number'>page_number</span><span class='op'>|</span>
    <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='lparen'>(</span><span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>page:</span> <span class='id identifier rubyid_page_number'>page_number</span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_mailboxes'>mailboxes</span> <span class='op'>+=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mailbox'>mailbox</span><span class='op'>|</span> <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_mailbox'>mailbox</span> <span class='rbrace'>}</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:per_page</span><span class='comma'>,</span> <span class='int'>100</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_mailboxes'>mailboxes</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="delete-instance_method">
  
    #<strong>delete</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete the mailbox and it&#39;s contents. If you delete a mailbox for which you have purchased a slot, this action frees the slot so it once again becomes available for use with a new mailbox, or for deletion.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The confirmation message from Gandi.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/GandiError.html" title="GandiV5::Error::GandiError (class)">GandiV5::Error::GandiError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if Gandi returns an error.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id" target="_parent" title="https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id">https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
  <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='id identifier rubyid_url'>url</span>
  <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="purge-instance_method">
  
    #<strong>purge</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Purge the contents of the mailbox.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The confirmation message from Gandi.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/GandiError.html" title="GandiV5::Error::GandiError (class)">GandiV5::Error::GandiError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if Gandi returns an error.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents" target="_parent" title="https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents">https://api.gandi.net/docs/email#delete-v5-email-mailboxes-domain-mailbox_id-contents</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_purge'>purge</span>
  <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="../../GandiV5.html#delete-class_method" title="GandiV5.delete (method)">delete</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/contents</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="quota-instance_method">
  
    #<strong>quota</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the quota for this type of mailbox.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>bytes.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_quota'>quota</span>
  <span class='const'><span class='object_link'><a href="#QUOTAS-constant" title="GandiV5::Email::Mailbox::QUOTAS (constant)">QUOTAS</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_type'>type</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="quota_usage-instance_method">
  
    #<strong>quota_usage</strong>  &#x21d2; <tt>Float</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the quota usage for this mailbox.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>fraction of quota used (typically between 0.0 and 1.0)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 189</span>

<span class='kw'>def</span> <span class='id identifier rubyid_quota_usage'>quota_usage</span>
  <span class='id identifier rubyid_quota_used'>quota_used</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_quota'>quota</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="refresh-instance_method">
  
    #<strong>refresh</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Requery Gandi fo this mailbox&#39;s information.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="GandiV5::Email::Mailbox (class)">GandiV5::Email::Mailbox</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/GandiError.html" title="GandiV5::Error::GandiError (class)">GandiV5::Error::GandiError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if Gandi returns an error.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 79</span>

<span class='kw'>def</span> <span class='id identifier rubyid_refresh'>refresh</span>
  <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get'><span class='object_link'><a href="../../GandiV5.html#get-class_method" title="GandiV5.get (method)">get</a></span></span> <span class='id identifier rubyid_url'>url</span>
  <span class='id identifier rubyid_from_gandi'>from_gandi</span> <span class='id identifier rubyid_data'>data</span>
  <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mb'>mb</span><span class='op'>|</span> <span class='ivar'>@mailbox</span> <span class='op'>=</span> <span class='id identifier rubyid_mb'>mb</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_responder?'>responder?</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    #<strong>to_s</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the string representation of the mailbox. Includes the type, address, quota usage, activeness of responder (if present) and aliases (if present).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota_used'>quota_used</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_quota'>quota</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_quota_usage'>quota_usage</span> <span class='op'>*</span> <span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='embexpr_end'>}</span><span class='tstring_content'>%))</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inactive</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> responder</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_responder'>responder</span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> aka: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aliases'>aliases</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_aliases'>aliases</span><span class='op'>&amp;.</span><span class='id identifier rubyid_any?'>any?</span>
  <span class='id identifier rubyid_s'>s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update-instance_method">
  
    #<strong>update</strong>(**body)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Update the mailbox&#39;s settings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>login</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the login name (and first part of email address).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the password to use.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>aliases</span>
      
      
        <span class='type'>(<tt>Array&lt;String, #<span class='object_link'><a href="#to_s-instance_method" title="GandiV5::Email::Mailbox#to_s (method)">to_s</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>any alternative email address to be used.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>responder</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt>GandiV5::Mailbox::Responder</tt>, <tt>#<span class='object_link'><a href="../Data.html#to_gandi-instance_method" title="GandiV5::Data#to_gandi (method)">to_gandi</a></span></tt>, <tt>#<span class='object_link'><a href="../Data.html#to_h-instance_method" title="GandiV5::Data#to_h (method)">to_h</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>auto responder settings.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The confirmation message from Gandi.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error/GandiError.html" title="GandiV5::Error::GandiError (class)">GandiV5::Error::GandiError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if Gandi returns an error.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id" target="_parent" title="https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id">https://api.gandi.net/docs/email#patch-v5-email-mailboxes-domain-mailbox_id</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99
100
101
102
103
104
105
106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gandi_v5/email/mailbox.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nothing to update.</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_check_password'>check_password</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_crypt_password'>crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:password</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_responder'>responder</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:responder</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_gandi</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_gandi'>to_gandi</span> <span class='op'>:</span> <span class='id identifier rubyid_responder'>responder</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid__response'>_response</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../GandiV5.html" title="GandiV5 (class)">GandiV5</a></span></span><span class='period'>.</span><span class='id identifier rubyid_patch'><span class='object_link'><a href="../../GandiV5.html#patch-class_method" title="GandiV5.patch (method)">patch</a></span></span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
  <span class='id identifier rubyid_refresh'>refresh</span>
  <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>message</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Jul 22 16:44:29 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.6.3).
</div>

    </div>
  </body>
</html>